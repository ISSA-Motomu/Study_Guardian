# 要件定義 & 画面設計 (2026 Edition)

## 🎯 コンセプト: "Study & RPG Hybrid"
**「最強の記録ツール」** (Study) と **「ゲーミフィケーション」** (Game) を融合させる。
この2つの世界を **Economy Loop (通貨システム)** で接続し、学習へのモチベーションを最大化する。

---

## 📱 4つのメインビュー (The Quad Views)

### 1. ⏱️ Study画面 (The Tool)
**「本家の使いやすさ」を再現。清潔感・効率重視。**
- **UIテーマ**: 白背景、アクセントカラー（青・緑）
- **機能**:
  - **Big Stopwatch**: 中央に大きく時間表示
  - **教材選択**: 登録済み教材をワンタップで開始
  - **目標管理**: 学習目標の作成・編集・削除。進捗バーで達成度を可視化
  - **本棚機能**: 教材を管理・整理できるデジタル本棚
  - **ショップ**: EXPでご褒美アイテムを購入

### 2. ⚔️ Game画面 (The Fantasy)
**「ゲーミフィケーション」。達成感・中毒性重視。**
- **UIテーマ**: 黒背景、ゴールド・赤の装飾（ダークファンタジー）
- **機能**:
  - **オートバトル**: 放置バトルでモンスターと戦闘（勉強中以外も進行）
  - **進化ゲーム**: 勉強時間でペットを育成・進化させる
  - **ガチャ**: 勉強報酬で引ける仲間・装備ガチャ

### 3. 📊 Data画面 (The Visualization)
**「努力の可視化」。収集癖を刺激する。**
- **UIテーマ**: 情報整理されたダッシュボード
- **機能**:
  - **週間グラフ**: 勉強量の棒グラフ推移
  - **ランキング**: ユーザー間のEXPランキング
  - **タイムライン**: 最近のアクティビティ一覧
  - **勉強中バナー**: 他のユーザーの勉強状況をリアルタイム表示

### 4. ⚙️ その他画面 (The Settings)
**「設定と情報」。アプリの管理。**
- **UIテーマ**: クリーンな設定リスト
- **機能**:
  - **ユーザー情報**: プロフィール表示
  - **学習統計**: 累計時間・EXP・レベル
  - **実績一覧**: 獲得した実績バッジ
  - **使い方ガイド**: アプリの説明
  - **管理者メニュー**: 承認・設定管理（ADMIN専用）

---

## 🔁 経済圏の設計 (Economy Loop)

| 通貨 | 獲得方法 | 用途 |
| --- | --- | --- |
| **EXP (経験値)** | 勉強時間 (1分 = 10 EXP) | アバターのレベルアップ、ショップでの購入 |
| **Gold (お金)** | 放置バトル、勉強完了ボーナス | 武器防具の購入、施設強化 |
| **進化ポイント** | 勉強時間、目標達成 | ペットの進化・成長 |

> **Core Loop**: 「ご褒美欲しい (Shop) → 勉強してEXP貯める (Study) → 購入申請 → 承認 → ご褒美ゲット」

---

## 🚀 開発ロードマップ

### Phase 1: 基礎構造 ✅ COMPLETED
- [x] 4タブUIの実装 (Study/Game/Data/Other)
- [x] LIFFアプリケーション基盤
- [x] Google Sheets連携
- [x] 通貨システム (EXP) のDB実装

### Phase 2: 学習機能 ✅ COMPLETED
- [x] 勉強タイマー（ストップウォッチ）
- [x] 科目選択・記録
- [x] 目標管理機能
- [x] 本棚機能（教材管理）

### Phase 3: ゲーミフィケーション ✅ COMPLETED
- [x] オートバトルシステム
- [x] 進化ゲーム
- [x] ガチャシステム
- [x] 実績システム

### Phase 4: データ & ソーシャル ✅ COMPLETED
- [x] 週間学習グラフ
- [x] ランキング機能
- [x] タイムライン（アクティビティ）
- [x] 通知システム（承認結果通知）

### Phase 5: 管理機能 ✅ COMPLETED
- [x] 承認ワークフロー（勉強・ジョブ・ショップ・ミッション）
- [x] ユーザー管理
- [x] アナウンス機能（対象ユーザー選択）
- [x] なりすまし機能（ユーザー視点で確認）

### Phase 6: 最適化 🔄 IN PROGRESS
- [x] APIレート制限対策（キャッシュ機能）
- [x] 429エラーハンドリング
- [ ] オフライン対応（Service Worker強化）
- [ ] パフォーマンス最適化

---

## 📋 データ構造

詳細は [Requirement.md](./Requirement.md) を参照。

| シート | 用途 |
| --- | --- |
| `users` | ユーザー情報・残高・ランク |
| `study_log` | 学習記録（承認待ち含む） |
| `shop_items` | 商品マスタ |
| `shop_requests` | 購入リクエスト |
| `jobs` | お手伝いタスク |
| `missions` | ミッション・クエスト |
| `transactions` | 取引履歴 |
| `notifications` | アプリ内通知 |
| `goals` | 学習目標 |
| `materials` | 教材マスタ |
| `bookshelf` | ユーザー本棚 |

---

## 🔧 技術スタック

- **Frontend**: Vue 3 + Pinia + Tailwind CSS
- **Backend**: Python Flask
- **Database**: Google Sheets (gspread)
- **Platform**: LINE LIFF + Messaging API
- **Hosting**: Render
- [ ] タイムライン & コメント機能

